# ğŸš€ æ ¸å¿ƒçŸ¥è¯†ç‚¹é€ŸæŸ¥æ‰‹å†Œ

> è€ƒè¯•å‰15åˆ†é’Ÿå¿«é€Ÿå¤ä¹ ï¼Œæ¶µç›–æ‰€æœ‰é«˜é¢‘è€ƒç‚¹

## ğŸ“‹ ç›®å½•
- [Kubernetesæ ¸å¿ƒé—®é¢˜](#kubernetesæ ¸å¿ƒé—®é¢˜)
- [Goè¯­è¨€è¦ç‚¹](#goè¯­è¨€è¦ç‚¹)
- [åˆ†å¸ƒå¼ç³»ç»Ÿ](#åˆ†å¸ƒå¼ç³»ç»Ÿ)
- [ä¸­é—´ä»¶æŠ€æœ¯](#ä¸­é—´ä»¶æŠ€æœ¯)
- [ç®—æ³•å¿…å¤‡](#ç®—æ³•å¿…å¤‡)

---

## Kubernetesæ ¸å¿ƒé—®é¢˜

### ğŸ” Image Pending æƒ…å†µåˆ†æ
**é•œåƒæ‹‰å–é—®é¢˜**
- âŒ é•œåƒä¸å­˜åœ¨æˆ–æ ‡ç­¾é”™è¯¯
- âŒ ç½‘ç»œè¿æ¥é—®é¢˜ï¼ˆä»“åº“ä¸å¯è¾¾ï¼‰
- âŒ è®¤è¯å¤±è´¥ï¼ˆç§æœ‰ä»“åº“å‡­æ®é”™è¯¯ï¼‰
- âŒ é•œåƒè¿‡å¤§å¯¼è‡´æ‹‰å–è¶…æ—¶

**èµ„æºè°ƒåº¦é—®é¢˜**
- âŒ èŠ‚ç‚¹èµ„æºä¸è¶³ï¼ˆCPU/å†…å­˜/å­˜å‚¨ï¼‰
- âŒ nodeSelectoré™åˆ¶æ— åŒ¹é…èŠ‚ç‚¹
- âŒ æ±¡ç‚¹å®¹å¿åº¦ä¸åŒ¹é…
- âŒ äº²å’Œæ€§è§„åˆ™æ— æ³•æ»¡è¶³

**å­˜å‚¨é—®é¢˜**
- âŒ PVCæ— æ³•ç»‘å®šåˆ°PV
- âŒ å­˜å‚¨ç±»ä¸å¯ç”¨

### ğŸŒ Kubernetesç½‘ç»œæ¨¡å‹å¯¹æ¯”

| ç½‘ç»œæ’ä»¶ | å®ç°æ–¹å¼ | æ€§èƒ½ | ç½‘ç»œç­–ç•¥ | é€‚ç”¨åœºæ™¯ |
|---------|---------|------|---------|---------|
| **Flannel** | VXLAN/UDP Overlay | ä¸€èˆ¬ | âŒ | å°è§„æ¨¡é›†ç¾¤ |
| **Calico** | BGPçº¯ä¸‰å±‚ | ä¼˜ç§€ | âœ… | å¤§è§„æ¨¡ç”Ÿäº§ |
| **Weave** | Overlay + åŠ å¯† | ä¸€èˆ¬ | âœ… | å®‰å…¨è¦æ±‚é«˜ |
| **Cilium** | eBPF | æä½³ | âœ… | ç°ä»£åŒ–é›†ç¾¤ |

### ğŸ—„ï¸ ELKé›†ç¾¤å¤‡ä»½ç­–ç•¥
```bash
# 1. åˆ›å»ºå¿«ç…§ä»“åº“
PUT /_snapshot/backup_repo
{
  "type": "fs",
  "settings": {
    "location": "/backup/elasticsearch"
  }
}

# 2. åˆ›å»ºå¿«ç…§
PUT /_snapshot/backup_repo/snapshot_1
{
  "indices": "*",
  "ignore_unavailable": true
}

# 3. æ¢å¤å¿«ç…§
POST /_snapshot/backup_repo/snapshot_1/_restore
```

### ğŸ³ Docker vs Containerd

| ç‰¹æ€§ | Docker | Containerd |
|------|--------|------------|
| **å®šä½** | å®Œæ•´å®¹å™¨å¹³å° | å®¹å™¨è¿è¡Œæ—¶ |
| **æ¶æ„** | åˆ†å±‚æ¶æ„ | ç²¾ç®€æ¶æ„ |
| **æ€§èƒ½** | è¾ƒé‡ | è½»é‡é«˜æ•ˆ |
| **K8sé›†æˆ** | é€šè¿‡dockershim | åŸç”ŸCRI |
| **é•œåƒç®¡ç†** | Docker CLI | crictl |

### ğŸ”Œ ç½‘ç»œæ’ä»¶å®ç°åŸç†
```yaml
# CNIæ’ä»¶å·¥ä½œæµç¨‹
1. kubeletè°ƒç”¨CNIæ’ä»¶
2. åˆ›å»ºç½‘ç»œå‘½åç©ºé—´
3. åˆ›å»ºveth pair
4. é…ç½®IPåœ°å€å’Œè·¯ç”±
5. è¿æ¥åˆ°ç½‘æ¡¥æˆ–éš§é“
```

### ğŸ“Š Prometheusè‡ªåŠ¨å‘ç°
```yaml
# KubernetesæœåŠ¡å‘ç°é…ç½®
scrape_configs:
  - job_name: 'kubernetes-pods'
    kubernetes_sd_configs:
    - role: pod
    relabel_configs:
    - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]
      action: keep
      regex: true
    - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_port]
      action: replace
      target_label: __address__
      regex: (.+)
      replacement: ${1}
```

### ğŸ”§ ESåˆ†ç‰‡ä¿®æ”¹é™åˆ¶
- âœ… **å‰¯æœ¬åˆ†ç‰‡**: å¯åŠ¨æ€ä¿®æ”¹
- âŒ **ä¸»åˆ†ç‰‡**: åˆ›å»ºåä¸å¯ä¿®æ”¹
- ğŸ”„ **è§£å†³æ–¹æ¡ˆ**: Reindex APIé‡å»ºç´¢å¼•

### ğŸ”´ Redis Clusteré«˜å¯ç”¨
- **æœ€å°‘èŠ‚ç‚¹**: 6ä¸ªï¼ˆ3ä¸»3ä»ï¼‰
- **æ•…éšœè½¬ç§»**: è‡ªåŠ¨ä¸»ä»åˆ‡æ¢
- **æ•°æ®åˆ†ç‰‡**: 16384ä¸ªå“ˆå¸Œæ§½
- **è„‘è£‚é¢„é˜²**: éœ€è¦å¥‡æ•°ä¸ªä¸»èŠ‚ç‚¹

### ğŸ—‘ï¸ K8sèŠ‚ç‚¹åˆ é™¤æµç¨‹
```bash
# 1. æ ‡è®°ä¸å¯è°ƒåº¦
kubectl cordon <node-name>

# 2. é©±é€Pod
kubectl drain <node-name> --ignore-daemonsets --delete-emptydir-data

# 3. åˆ é™¤èŠ‚ç‚¹
kubectl delete node <node-name>

# 4. èŠ‚ç‚¹æ¸…ç†
kubeadm reset
```

---

## Goè¯­è¨€è¦ç‚¹

### ğŸ”„ Channelå…³é—­æ£€æµ‹
```go
// æ–¹æ³•1: okè¯­æ³•
v, ok := <-ch
if !ok {
    // channelå·²å…³é—­
}

// æ–¹æ³•2: rangeéå†ï¼ˆæ¨èï¼‰
for v := range ch {
    // å¤„ç†æ•°æ®
}
```

### ğŸ§µ Goroutine vs Thread
- **Goroutine**: 2KBåˆå§‹æ ˆï¼ŒåŠ¨æ€å¢é•¿
- **Thread**: 8MBå›ºå®šæ ˆ
- **è°ƒåº¦**: GMPæ¨¡å‹ vs å†…æ ¸è°ƒåº¦

### ğŸ—‘ï¸ GCæœºåˆ¶
- **ä¸‰è‰²æ ‡è®°**: ç™½è‰²(å¾…å›æ”¶) â†’ ç°è‰²(æ ‡è®°ä¸­) â†’ é»‘è‰²(å­˜æ´»)
- **å†™å±éšœ**: é˜²æ­¢å¹¶å‘ä¿®æ”¹å¯¼è‡´çš„é”™è¯¯å›æ”¶
- **STWæ—¶é—´**: Go 1.8+ < 1ms

---

## åˆ†å¸ƒå¼ç³»ç»Ÿ

### ğŸ¯ CAPç†è®º
- **C (Consistency)**: ä¸€è‡´æ€§
- **A (Availability)**: å¯ç”¨æ€§  
- **P (Partition tolerance)**: åˆ†åŒºå®¹é”™æ€§
- **å®šç†**: æœ€å¤šåŒæ—¶æ»¡è¶³ä¸¤ä¸ª

### ğŸ—³ï¸ Raftç®—æ³•æ ¸å¿ƒ
1. **Leaderé€‰ä¸¾**: å¿ƒè·³æœºåˆ¶ï¼Œä»»æœŸæ¦‚å¿µ
2. **æ—¥å¿—å¤åˆ¶**: å¼ºä¸€è‡´æ€§ä¿è¯
3. **å®‰å…¨æ€§**: Leaderå®Œæ•´æ€§åŸåˆ™

---

## ä¸­é—´ä»¶æŠ€æœ¯

### ğŸ“¨ Kafkaä¸€è‡´æ€§ä¿è¯
```yaml
# ç”Ÿäº§è€…é…ç½®
acks: all                    # ç­‰å¾…æ‰€æœ‰å‰¯æœ¬ç¡®è®¤
retries: 2147483647         # æœ€å¤§é‡è¯•
enable.idempotence: true    # å¹‚ç­‰æ€§
```

### ğŸ”‘ etcdæ ¸å¿ƒç‰¹æ€§
- **Watchæœºåˆ¶**: ç›‘å¬keyå˜åŒ–
- **ç§Ÿçº¦(Lease)**: TTLè‡ªåŠ¨è¿‡æœŸ
- **äº‹åŠ¡**: åŸå­æ€§æ“ä½œ

---

## ç®—æ³•å¿…å¤‡

### ğŸ¯ é«˜é¢‘é¢˜å‹
1. **æ•°ç»„**: ä¸¤æ•°ä¹‹å’Œã€ä¸‰æ•°ä¹‹å’Œã€å»é‡
2. **å­—ç¬¦ä¸²**: æœ€é•¿æ— é‡å¤å­ä¸²ã€å›æ–‡
3. **é“¾è¡¨**: åè½¬ã€åˆå¹¶ã€ç¯æ£€æµ‹
4. **æ ˆé˜Ÿåˆ—**: æœ‰æ•ˆæ‹¬å·ã€æœ€å°æ ˆ
5. **æ ‘**: éå†ã€æ·±åº¦ã€å¯¹ç§°æ€§

### âš¡ æ—¶é—´å¤æ‚åº¦é€Ÿè®°
- **O(1)**: å“ˆå¸Œè¡¨æŸ¥æ‰¾
- **O(log n)**: äºŒåˆ†æœç´¢ã€å †æ“ä½œ
- **O(n)**: çº¿æ€§æ‰«æã€BFS/DFS
- **O(n log n)**: å¿«æ’ã€å½’å¹¶æ’åº
- **O(nÂ²)**: å†’æ³¡æ’åºã€æš´åŠ›è§£æ³•

---

## ğŸª è€ƒè¯•ç­”é¢˜æ¨¡æ¿

### æŠ€æœ¯é—®é¢˜5æ­¥æ³•
1. **ç†è§£ç¡®è®¤** - "æˆ‘ç†è§£çš„é—®é¢˜æ˜¯..."
2. **æ€è·¯åˆ†æ** - "æˆ‘çš„è§£å†³æ€è·¯æ˜¯..."
3. **ä»£ç å®ç°** - "è®©æˆ‘æ¥å®ç°ä¸€ä¸‹..."
4. **æµ‹è¯•éªŒè¯** - "è€ƒè™‘è¾¹ç•Œæƒ…å†µ..."
5. **ä¼˜åŒ–æ”¹è¿›** - "å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–..."

### é¡¹ç›®ç»éªŒSTARæ³•
- **S(Situation)**: é¡¹ç›®èƒŒæ™¯
- **T(Task)**: å…·ä½“ä»»åŠ¡
- **A(Action)**: æŠ€æœ¯æ–¹æ¡ˆ
- **R(Result)**: æœ€ç»ˆæ•ˆæœ

---

## ğŸ”¥ åŠ åˆ†å›ç­”

### å±•ç¤ºæ·±åº¦æ€è€ƒ
- "è¿™ä¸ªé—®é¢˜è¿˜å¯ä»¥ä»...è§’åº¦è€ƒè™‘"
- "åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘..."
- "è¿™ç§æ–¹æ¡ˆçš„trade-offæ˜¯..."

### ä½“ç°å®æˆ˜ç»éªŒ
- "åœ¨æˆ‘ä¹‹å‰çš„é¡¹ç›®ä¸­..."
- "æˆ‘ä»¬é‡åˆ°è¿‡ç±»ä¼¼é—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯..."
- "æ ¹æ®æˆ‘çš„ç»éªŒï¼Œæœ€ä½³å®è·µæ˜¯..."

---

**ğŸ’¡ è®°ä½**: ä¿æŒè‡ªä¿¡ï¼Œå±•ç¤ºå­¦ä¹ èƒ½åŠ›ï¼Œè¯šå®é¢å¯¹ä¸ä¼šçš„é—®é¢˜ï¼ 